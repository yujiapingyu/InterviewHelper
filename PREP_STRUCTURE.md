# PREP 结构说明

## 所有AI生成答案现在都使用统一的PREP结构

### 4个使用PREP结构的函数

✅ **1. generateQuestions()** - 生成问题时的模范回答
✅ **2. evaluateAnswer()** - 评估答案的改进版本
✅ **3. evaluateFollowUpAnswer()** - 评估追问答案的改进版本
✅ **4. generateQuestionAnalysis()** - AI分析问题生成的模范回答

---

## PREP 结构格式

### 必须严格遵循的格式：

```
【Point】
[1-2句话：陈述你的主要结论/立场]

【Reason】
[2-3句话：解释为什么，使用 ～ので、～から、～ため]

【Example】
[2-3句话：给出具体例子，以"例えば"开头]

【Point】
[1-2句话：重申结论]
```

### 关键规则：

1. ✅ **必须包含所有4个部分**，带【】标记
2. ✅ **每个标记后必须换行**
3. ✅ **使用完整的句子**（不要碎片化）
4. ❌ **避免过多"あの"**（整个回答最多1-2次）
5. ✅ **使用自然连接词**：～んです、～ので、～から
6. ✅ **听起来像N2-N1水平**（流利、专业）
7. ✅ **可以在【Point】前用一次"そうですね"**

---

## 正确示例

```
【Point】
私はチームで協力して成果を上げることを大切にしています。

【Reason】
なぜなら、一人では限界があるので、チームメンバーと協力することで、お互いの強みを活かせるからです。また、多様な視点を取り入れることで、より良い解決策を見つけることができます。

【Example】
例えば、前職では新機能の開発プロジェクトで、フロントエンドとバックエンドのエンジニアが密接に協力しました。週次ミーティングで進捗を共有し、課題を一緒に解決した結果、予定より2週間早くリリースできました。

【Point】
このように、チームワークを大切にする文化で働きたいと思っています。
```

---

## 错误示例（避免）

❌ **缺少标记或结构**
```
私はチームで協力して...なぜなら...例えば...
```

❌ **过多停顿词**
```
あの、私は、あの、チームとして、あの、協力して、あの...
```

❌ **碎片化的句子**
```
チーム。協力。大切。なぜなら...
```

---

## 测试方法

1. **生成新问题** → 检查 `model_answer_ja` 是否有【Point】【Reason】【Example】【Point】
2. **评估答案** → 检查 `correctedVersion` 是否遵循PREP结构
3. **追问评估** → 检查 `correctedVersion` 是否遵循PREP结构
4. **AI分析问题** → 检查生成的 `model_answer_ja` 是否遵循PREP结构

---

## 代码位置

- `server/gemini.js` 第 150-195行: `generateQuestions()`
- `server/gemini.js` 第 282行: `evaluateAnswer()` correctedVersion
- `server/gemini.js` 第 419行: `evaluateFollowUpAnswer()` correctedVersion
- `server/gemini.js` 第 638-670行: `generateQuestionAnalysis()`

所有4个地方现在都使用统一的PREP结构要求！
